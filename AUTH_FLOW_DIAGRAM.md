# Authentication Flow Diagram

## Registration Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                         Registration Flow                            │
└─────────────────────────────────────────────────────────────────────┘

    User                  Register.jsx            AuthContext          authService              Backend API
     │                         │                       │                    │                        │
     │  1. Select Role        │                       │                    │                        │
     ├────────────────────────>│                       │                    │                        │
     │                         │                       │                    │                        │
     │  2. Fill Form          │                       │                    │                        │
     ├────────────────────────>│                       │                    │                        │
     │                         │                       │                    │                        │
     │  3. Click Submit       │                       │                    │                        │
     ├────────────────────────>│                       │                    │                        │
     │                         │                       │                    │                        │
     │                         │  4. Call register()   │                    │                        │
     │                         ├──────────────────────>│                    │                        │
     │                         │                       │                    │                        │
     │                         │                       │  5. Call signUp()  │                        │
     │                         │                       ├───────────────────>│                        │
     │                         │                       │                    │                        │
     │                         │                       │                    │  6. POST /api/auth/signup
     │                         │                       │                    ├───────────────────────>│
     │                         │                       │                    │                        │
     │                         │                       │                    │  7. Validate Data      │
     │                         │                       │                    │<───────────────────────┤
     │                         │                       │                    │                        │
     │                         │                       │                    │  8. Create User        │
     │                         │                       │                    │<───────────────────────┤
     │                         │                       │                    │                        │
     │                         │                       │                    │  9. Generate Tokens    │
     │                         │                       │                    │<───────────────────────┤
     │                         │                       │                    │                        │
     │                         │                       │                    │ 10. Response + Cookie  │
     │                         │                       │                    │<───────────────────────┤
     │                         │                       │                    │                        │
     │                         │                       │ 11. Store Token    │                        │
     │                         │                       │<───────────────────┤                        │
     │                         │                       │  (localStorage)    │                        │
     │                         │                       │                    │                        │
     │                         │  12. Return User Data │                    │                        │
     │                         │<──────────────────────┤                    │                        │
     │                         │                       │                    │                        │
     │  13. Show Success       │                       │                    │                        │
     │<────────────────────────┤                       │                    │                        │
     │                         │                       │                    │                        │
     │  14. Redirect           │                       │                    │                        │
     │<────────────────────────┤                       │                    │                        │
     │                         │                       │                    │                        │
```

## Login Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                           Login Flow                                 │
└─────────────────────────────────────────────────────────────────────┘

    User                    Login.jsx            AuthContext          authService              Backend API
     │                         │                       │                    │                        │
     │  1. Select Role        │                       │                    │                        │
     ├────────────────────────>│                       │                    │                        │
     │                         │                       │                    │                        │
     │  2. Enter Credentials  │                       │                    │                        │
     ├────────────────────────>│                       │                    │                        │
     │                         │                       │                    │                        │
     │  3. Click Submit       │                       │                    │                        │
     ├────────────────────────>│                       │                    │                        │
     │                         │                       │                    │                        │
     │                         │  4. Call login()      │                    │                        │
     │                         ├──────────────────────>│                    │                        │
     │                         │                       │                    │                        │
     │                         │                       │  5. Call login()   │                        │
     │                         │                       ├───────────────────>│                        │
     │                         │                       │                    │                        │
     │                         │                       │                    │  6. POST /api/auth/login
     │                         │                       │                    ├───────────────────────>│
     │                         │                       │                    │                        │
     │                         │                       │                    │  7. Verify Credentials │
     │                         │                       │                    │<───────────────────────┤
     │                         │                       │                    │                        │
     │                         │                       │                    │  8. Check Role Match   │
     │                         │                       │                    │<───────────────────────┤
     │                         │                       │                    │                        │
     │                         │                       │                    │  9. Generate Tokens    │
     │                         │                       │                    │<───────────────────────┤
     │                         │                       │                    │                        │
     │                         │                       │                    │ 10. Response + Cookie  │
     │                         │                       │                    │<───────────────────────┤
     │                         │                       │                    │                        │
     │                         │                       │ 11. Store Token    │                        │
     │                         │                       │<───────────────────┤                        │
     │                         │                       │  (localStorage)    │                        │
     │                         │                       │                    │                        │
     │                         │  12. Return User Data │                    │                        │
     │                         │<──────────────────────┤                    │                        │
     │                         │                       │                    │                        │
     │  13. Show Success       │                       │                    │                        │
     │<────────────────────────┤                       │                    │                        │
     │                         │                       │                    │                        │
     │  14. Redirect           │                       │                    │                        │
     │<────────────────────────┤                       │                    │                        │
     │                         │                       │                    │                        │
```

## Session Persistence Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                      Session Persistence                             │
└─────────────────────────────────────────────────────────────────────┘

    Browser              AuthContext         localStorage         Backend API
       │                      │                    │                   │
       │  1. Page Load/       │                    │                   │
       │     Refresh          │                    │                   │
       ├─────────────────────>│                    │                   │
       │                      │                    │                   │
       │                      │  2. Check Storage  │                   │
       │                      ├───────────────────>│                   │
       │                      │                    │                   │
       │                      │  3. Get User Data  │                   │
       │                      │<───────────────────┤                   │
       │                      │                    │                   │
       │                      │  4. Get Token      │                   │
       │                      ├───────────────────>│                   │
       │                      │                    │                   │
       │                      │  5. Return Token   │                   │
       │                      │<───────────────────┤                   │
       │                      │                    │                   │
       │                      │  6. Set User State │                   │
       │                      │  (Logged In)       │                   │
       │                      │                    │                   │
       │  7. Show Dashboard   │                    │                   │
       │<─────────────────────┤                    │                   │
       │                      │                    │                   │
```

## Logout Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                          Logout Flow                                 │
└─────────────────────────────────────────────────────────────────────┘

    User               Component           AuthContext         authService         localStorage
     │                     │                    │                   │                    │
     │  1. Click Logout   │                    │                   │                    │
     ├────────────────────>│                    │                   │                    │
     │                     │                    │                   │                    │
     │                     │  2. Call logout()  │                   │                    │
     │                     ├───────────────────>│                   │                    │
     │                     │                    │                   │                    │
     │                     │                    │  3. Call logout() │                    │
     │                     │                    ├──────────────────>│                    │
     │                     │                    │                   │                    │
     │                     │                    │                   │  4. Remove Token   │
     │                     │                    │                   ├───────────────────>│
     │                     │                    │                   │                    │
     │                     │                    │  5. Clear State   │                    │
     │                     │                    │<──────────────────┤                    │
     │                     │                    │                   │                    │
     │                     │                    │  6. Remove User   │                    │
     │                     │                    ├──────────────────────────────────────>│
     │                     │                    │                   │                    │
     │                     │  7. Return         │                   │                    │
     │                     │<───────────────────┤                   │                    │
     │                     │                    │                   │                    │
     │  8. Redirect Login  │                    │                   │                    │
     │<────────────────────┤                    │                   │                    │
     │                     │                    │                   │                    │
```

## Error Handling Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                        Error Handling                                │
└─────────────────────────────────────────────────────────────────────┘

    Component           api.js            Backend API         Component
       │                  │                    │                  │
       │  1. API Request  │                    │                  │
       ├─────────────────>│                    │                  │
       │                  │                    │                  │
       │                  │  2. Fetch Request  │                  │
       │                  ├───────────────────>│                  │
       │                  │                    │                  │
       │                  │  3. Error Response │                  │
       │                  │<───────────────────┤                  │
       │                  │  (400/401/409)     │                  │
       │                  │                    │                  │
       │                  │  4. Parse Error    │                  │
       │                  │  Create ApiError   │                  │
       │                  │                    │                  │
       │  5. Throw Error  │                    │                  │
       │<─────────────────┤                    │                  │
       │                  │                    │                  │
       │  6. Catch Error  │                    │                  │
       │  Show Toast      │                    │                  │
       │────────────────────────────────────────────────────────>│
       │                  │                    │                  │
       │                  │                    │  7. Display Toast│
       │                  │                    │<─────────────────┤
       │                  │                    │                  │
```

## Token Storage

```
┌─────────────────────────────────────────────────────────────────────┐
│                       Token Storage                                  │
└─────────────────────────────────────────────────────────────────────┘

┌────────────────────────────┐         ┌─────────────────────────────┐
│      localStorage          │         │      HttpOnly Cookie        │
│  (Accessible to JS)        │         │  (Not accessible to JS)     │
├────────────────────────────┤         ├─────────────────────────────┤
│                            │         │                             │
│  • accessToken             │         │  • refreshToken             │
│  • user: {                 │         │                             │
│      id: 1,                │         │  Set by Backend             │
│      name: "...",          │         │  Sent automatically         │
│      email: "...",         │         │  with requests              │
│      role: "..."           │         │                             │
│    }                       │         │  More Secure!               │
│                            │         │                             │
│  Used for:                 │         │  Used for:                  │
│  • Authorization Header    │         │  • Token Refresh            │
│  • User Info Display       │         │  • Long-term Session        │
│  • Session Persistence     │         │                             │
│                            │         │                             │
└────────────────────────────┘         └─────────────────────────────┘
```

## API Request Flow with Token

```
┌─────────────────────────────────────────────────────────────────────┐
│                    API Request with Token                            │
└─────────────────────────────────────────────────────────────────────┘

    Component           api.js          localStorage         Backend API
       │                  │                   │                   │
       │  1. Make Request │                   │                   │
       ├─────────────────>│                   │                   │
       │                  │                   │                   │
       │                  │  2. Get Token     │                   │
       │                  ├──────────────────>│                   │
       │                  │                   │                   │
       │                  │  3. Return Token  │                   │
       │                  │<──────────────────┤                   │
       │                  │                   │                   │
       │                  │  4. Add Headers:  │                   │
       │                  │  - Authorization: │                   │
       │                  │    Bearer <token> │                   │
       │                  │  - Content-Type   │                   │
       │                  │  - credentials    │                   │
       │                  │                   │                   │
       │                  │  5. Fetch Request │                   │
       │                  ├──────────────────────────────────────>│
       │                  │                   │                   │
       │                  │                   │  6. Verify Token  │
       │                  │                   │                   │
       │                  │  7. Response      │                   │
       │                  │<──────────────────────────────────────┤
       │                  │                   │                   │
       │  8. Return Data  │                   │                   │
       │<─────────────────┤                   │                   │
       │                  │                   │                   │
```

## Role-Based Navigation

```
┌─────────────────────────────────────────────────────────────────────┐
│                   Role-Based Navigation                              │
└─────────────────────────────────────────────────────────────────────┘

                          After Login/Register
                                   │
                                   │
                    ┌──────────────┴──────────────┐
                    │   Check User Role           │
                    └──────────────┬──────────────┘
                                   │
                    ┌──────────────┼──────────────┐
                    │              │              │
              ┌─────▼─────┐  ┌────▼─────┐  ┌────▼─────┐
              │ DEVELOPER │  │ RECRUITER│  │  ADMIN   │
              └─────┬─────┘  └────┬─────┘  └────┬─────┘
                    │             │             │
                    ▼             ▼             ▼
            /developer/   /recruiter/    /admin/
             dashboard      dashboard    dashboard
```
